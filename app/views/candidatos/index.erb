<% content_for :titulo_tela do %>
  Candidatos
<% end %>

<% content_for :lead do %>
  <%= @consulta_candidatos.count %> candidatos encontrados <br>
<% end %>

<div class="row">
    <%= form_tag nil, :method=>'GET' do %>
      <div class="col-lg-8">
        <%= text_field_tag 'nome', params['nome'], :class=>'form-control'  %>

      </div>

      <div class="col-lg-4">

        <%= submit_tag 'pesquisar', :class=>'form-control' %>
      </div>
    <%end%>


</div>

<div class="row">
  <div class='col-lg-12'>
    <hr/>
    <%= paginate @consulta_candidatos %>
  </div>
</div>







<div class="row">
  <div class='col-lg-12'>
    <table class="table table-bordered table-hover" style="font-size:0.9em;">

      <tr>
        <th> # </th>
        <th>
          Nome
        </th>

        <th>
          Estado
        </th>

        <th>
          Partido
        </th>

        <th style="text-align:right;">Total em doações (R$)</th>

        <th> </th>


      </tr>

      <% index = 0 %>
      <%
        offset = params['page'].to_i
        offset = 1 if offset == 0
        offset = (offset - 1) * 25
        index = offset
       %>



      <% @totais.sort_by{|id,valor|valor}.reverse.each do |candidato_id,valor| %>


        <tr>

          <td> <%=index = index + 1 %> </td>

          <td>
            <%= @candidatos[candidato_id].nome %>
          </td>

          <td>
            <%= @candidatos[candidato_id].estado %>
          </td>

          <td>
            <%= @partidos[@candidatos[candidato_id].partido_id.to_s] %>
          </td>

          <td style="text-align:right;">
            <%= total = number_to_currency(("%.2f" % (@candidatos[candidato_id]._total_em_doacoes/100)), unit:'', separator: ",", delimiter: ".") %>


          </td>

          <td style="text-align:right;"> <%= link_to 'doadores', candidato_path(candidato_id) %> </td>

        </tr>



      <%end%>

    </table>
  </div>
</div>

